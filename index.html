<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>FlareLink - Infinite Unblocked Links</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
<script src="https://cdn.tailwindcss.com"></script>
<style>
body, html { margin:0; padding:0; height:100%; background:#0a0a0f; font-family:'Inter',sans-serif; color:#eee; overflow:hidden; }
#app { display:flex; height:100vh; width:100vw; flex-direction:row; }
nav { background: rgba(20, 18, 34, 0.8); width:72px; display:flex; flex-direction:column; align-items:center; padding:1rem 0; border-right:1px solid #2c2a42; backdrop-filter: blur(15px); z-index:10; }
nav img.logo { width:36px; height:36px; margin-bottom:1rem; border-radius:8px; cursor:default; user-select:none; }
main { flex:1; position:relative; overflow:hidden; display:flex; flex-direction:column; justify-content:flex-start; align-items:center; padding:1.5rem 2rem; }
.search-bar { position:fixed; top:1rem; left:50%; transform:translateX(-50%); width:min(95vw,480px); background: rgba(30,25,50,0.4); backdrop-filter:blur(14px); border-radius:9999px; border:1px solid #6b21a8; display:flex; align-items:center; padding:0.5rem 1rem; gap:0.75rem; color:#ccc; font-size:1rem; z-index:15; }
.search-bar:focus-within { border-color:#a78bfa; color:#eee; }
.search-bar input { flex:1; background:transparent; border:none; color:#eee; font-size:1rem; outline:none; font-weight:500; }
.search-bar button { background:transparent; border:none; color:#ccc; cursor:pointer; font-size:1.15rem; transition:color 0.2s ease; }
.search-bar button:hover { color:#a78bfa; }
.cards-grid { margin-top:5rem; display:grid; grid-template-columns:repeat(auto-fill,minmax(120px,1fr)); gap:1.25rem; width:100%; max-width:960px; z-index:12; }
.card { background: rgba(255 255 255 / 0.05); border-radius:1rem; padding:1.25rem; box-shadow:0 0 8px rgb(135 85 239 / 0.3); backdrop-filter:blur(16px); cursor:pointer; user-select:none; display:flex; flex-direction:column; align-items:center; justify-content:center; transition: box-shadow 0.3s ease, background-color 0.3s ease; position:relative; }
.card:hover { background: rgba(255 255 255 / 0.15); box-shadow: 0 0 15px #8b5cf6aa; }
.card .favicon { width:56px; height:56px; margin-bottom:0.8rem; border-radius:14px; background:#222; object-fit:contain; filter:drop-shadow(0 0 4px #7c3aedaa); }
.card .label { font-weight:600; font-size:1.1rem; text-align:center; color:#ddd; user-select:none; }
.iframe-overlay { position:fixed; top:0; left:0; right:0; bottom:0; background: rgba(10,10,15,0.98); backdrop-filter: blur(18px); display:flex; flex-direction:column; z-index:50; }
.iframe-header { height:48px; background: rgba(30,20,50,0.8); backdrop-filter:blur(20px); display:flex; align-items:center; padding:0 1rem; gap:0.75rem; user-select:none; }
.iframe-header button { border:none; background: rgba(255 255 255 / 0.1); border-radius:8px; width:36px; height:36px; cursor:pointer; color:#ddd; font-size:1.2rem; transition:background-color 0.25s ease; }
.iframe-header button:hover { background: rgba(255 255 255 / 0.25); }
.iframe-header .title { flex:1; color:#ccc; font-weight:600; font-size:1.1rem; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
iframe { flex:1; border:none; width:100%; background:#0a0a0f; }
#particles-js { position:fixed; top:0; left:0; width:100vw; height:100vh; z-index:1; pointer-events:none; }
::-webkit-scrollbar { display:none; } scrollbar-width:none;
</style>
</head>
<body>

<div id="particles-js"></div>

<div id="app">
  <nav aria-label="Sidebar">
    <img src="https://storage.googleapis.com/a1aa/image/53f27051-c4bf-41e5-eab6-ee4e83df519e.jpg" alt="Logo" class="logo" draggable="false" />
  </nav>

  <main>
    <div class="search-bar" role="search">
      <input type="text" placeholder="Search FlareLink..." aria-label="Search FlareLink" id="search-input" autocomplete="off" spellcheck="false" />
      <button aria-label="Search" id="search-btn"><i class="fas fa-search"></i></button>
    </div>
    <div class="cards-grid" id="cards-container" aria-live="polite" aria-relevant="additions removals"></div>
  </main>
</div>

<div class="iframe-overlay" id="iframe-overlay" hidden>
  <div class="iframe-header">
    <button id="close-btn" aria-label="Close iframe"><i class="fas fa-times"></i></button>
    <button id="refresh-btn" aria-label="Refresh iframe"><i class="fas fa-redo"></i></button>
    <div class="title" id="iframe-title" title=""></div>
  </div>
  <iframe id="iframe" allowfullscreen sandbox="allow-scripts allow-same-origin allow-forms allow-pointer-lock"></iframe>
</div>

<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

<script>
(() => {
  const cardsData = [
    { id:'space', label:'Space', wildcards:['*.space'], domains:['blocksi.lol','deltamath.icu','desmos.lol','studentvue.my']},
    { id:'daydreamx', label:'DaydreamX', wildcards:['*.ddx'], domains:['blocksi.lol','desmosgraphing.xyz']},
    { id:'terbium', label:'Terbium OS', wildcards:['*.tb'], domains:['deltamath.icu','googledrive.icu']},
    { id:'nebula', label:'Nebula', wildcards:['*.nb'], domains:['nearpod.lol','stayinschooleducation.org']},
    { id:'xen', label:'Xen OS', wildcards:['*.xen'], domains:['prodigy.it.com','goguardian.pro']},
    { id:'chatgpt', label:'ChatGPT', wildcards:[''], domains:['chat.openai.com']}
  ];

  const cardsContainer = document.getElementById('cards-container');
  const iframeOverlay = document.getElementById('iframe-overlay');
  const iframe = document.getElementById('iframe');
  const iframeTitle = document.getElementById('iframe-title');
  const closeBtn = document.getElementById('close-btn');
  const refreshBtn = document.getElementById('refresh-btn');
  const searchInput = document.getElementById('search-input');

  let currentCard = null;

  function randomString(len = 5){ 
    const chars='abcdefghijklmnopqrstuvwxyz0123456789'; 
    let str=''; 
    for(let i=0;i<len;i++) str+=chars.charAt(Math.floor(Math.random()*chars.length)); 
    return str; 
  }

  function generateIframeUrl(card){
    if(card.id==='chatgpt') return `https://${card.domains[0]}`;
    const domain = card.domains[Math.floor(Math.random()*card.domains.length)];
    const wildcard = card.wildcards[Math.floor(Math.random()*card.wildcards.length)];
    const subdomain = randomString();
    const cleanedWildcard = wildcard.replace('*', subdomain);
    return `https://${cleanedWildcard}.${domain}.cdn.cloudflare.net`;
  }

  async function fetchFavicon(domain){
    const urls=[`https://${domain}/favicon.ico`,`https://www.google.com/s2/favicons?domain=${domain}`];
    for(const url of urls){
      try{
        await new Promise((res,rej)=>{ const img=new Image(); img.src=url; img.onload=()=>res(true); img.onerror=()=>rej(false); });
        return url;
      }catch{}
    }
    return 'https://via.placeholder.com/64?text=?';
  }

  async function renderCards(){
    cardsContainer.innerHTML='';
    for(const card of cardsData){
      const cardEl=document.createElement('div');
      cardEl.className='card';
      cardEl.setAttribute('role','button');
      cardEl.setAttribute('tabindex','0');
      cardEl.dataset.cardId = card.id;

      const img=document.createElement('img');
      img.className='favicon';
      img.alt=`${card.label} favicon`;
      img.src='https://via.placeholder.com/64?text=?'; // placeholder
      cardEl.appendChild(img);

      const label=document.createElement('div');
      label.className='label';
      label.textContent=card.label;
      cardEl.appendChild(label);

      cardEl.addEventListener('click',()=>{
        const url = generateIframeUrl(card);
        iframe.src = url;
        iframeTitle.textContent = `${card.label} â€” ${url}`;
        iframeTitle.title = url;
        iframeOverlay.hidden = false;
        currentCard = card;
      });

      cardEl.addEventListener('keydown', e=>{
        if(e.key==='Enter'||e.key===' '){ e.preventDefault(); cardEl.click(); }
      });

      cardsContainer.appendChild(cardEl);

      // fetch favicon asynchronously without blocking rendering
      fetchFavicon(card.domains[0]).then(url=>{ img.src = url; });
    }
  }

  closeBtn.addEventListener('click', ()=>{ iframe.src='about:blank'; iframeOverlay.hidden=true; currentCard=null; });
  refreshBtn.addEventListener('click', ()=>{ if(currentCard) iframe.src = generateIframeUrl(currentCard); });
  window.addEventListener('keydown', e=>{ if(e.key==='Escape' && !iframeOverlay.hidden) { iframe.src='about:blank'; iframeOverlay.hidden=true; currentCard=null; } });
  searchInput.addEventListener('input', ()=>{
    const filter=searchInput.value.toLowerCase().trim();
    [...cardsContainer.children].forEach(cardEl=>{
      const label = cardEl.querySelector('.label').textContent.toLowerCase();
      cardEl.style.display = label.includes(filter)?'':'none';
    });
  });

  // particles.js
  particlesJS('particles-js',{
    "particles":{"number":{"value":45,"density":{"enable":true,"value_area":900}},"color":{"value":"#8b5cf6"},"shape":{"type":"circle"},"opacity":{"value":0.2,"random":true},"size":{"value":4,"random":true},"move":{"enable":true,"speed":1.2,"direction":"none","random":true,"straight":false,"out_mode":"bounce","bounce":true}},
    "interactivity":{"detect_on":"canvas","events":{"onhover":{"enable":false},"onclick":{"enable":false}}},
    "retina_detect":true
  });

  renderCards();
})();
</script>
</body>
</html>
