<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Random StudentVue Viewer</title>
<style>
  /* Universal dark theme */
  * {
    background-color: #121212 !important;
    color: #ffffff !important;
    box-sizing: border-box;
  }

  body {
    margin: 0;
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    height: 100vh;
  }

  header {
    padding: 10px;
    background-color: #1f1f1f;
    text-align: center;
    font-size: 1.5em;
  }

  iframe {
    flex: 1;
    border: none;
    width: 100%;
    height: 100%;
    background-color: #121212;
  }

  button {
    background-color: #333;
    color: #fff;
    border: none;
    padding: 8px 12px;
    margin: 5px;
    cursor: pointer;
  }

  button:hover {
    background-color: #555;
  }
</style>
</head>
<body>
<header>
  Random StudentVue Viewer
  <button id="newLinkBtn">Generate New</button>
</header>
<iframe id="viewer" allowfullscreen></iframe>

<script>
const iframe = document.getElementById('viewer');
const newLinkBtn = document.getElementById('newLinkBtn');
const STORAGE_KEY = 'usedStudentVueStrings';

function generateRandomString(length = 6) {
  const chars = 'abcdefghijklmnopqrstuvwxyz0123456789';
  let result = '';
  for (let i = 0; i < length; i++) {
    result += chars[Math.floor(Math.random() * chars.length)];
  }
  return result;
}

function getUsedStrings() {
  return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
}

function saveUsedString(str) {
  const used = getUsedStrings();
  used.push(str);
  localStorage.setItem(STORAGE_KEY, JSON.stringify(used));
}

function generateUniqueSubdomain() {
  const used = new Set(getUsedStrings());
  let subdomain;
  do {
    subdomain = generateRandomString();
  } while (used.has(subdomain));
  saveUsedString(subdomain);
  return subdomain;
}

function loadRandomStudentVue() {
  const subdomain = generateUniqueSubdomain();
  const url = `https://${subdomain}.studentvue.my.cdn.cloudflare.net`;
  iframe.src = url;
}

// Button click generates a new random link
newLinkBtn.addEventListener('click', loadRandomStudentVue);

// Automatically load a random link on page load
loadRandomStudentVue();
</script>
</body>
</html>
