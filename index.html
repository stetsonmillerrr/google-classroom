<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Home</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Google+Sans&display=swap" rel="stylesheet">
<link rel="icon" type="image/png" href="https://ssl.gstatic.com/classroom/favicon.png">
<style>
body { font-family: "Google Sans", Arial, sans-serif; margin:0; padding:0; }
.category-list { max-height: 0; overflow: hidden; transition: max-height 0.35s ease, opacity 0.35s ease, margin 0.35s ease; opacity: 0; margin-top: 0; }
.category-list.open { opacity: 1; margin-top: 0.25rem; max-height: 500px; }
@keyframes shimmer {0%{background-position:-400px 0;}100%{background-position:400px 0;} }
.skeleton{position:relative;overflow:hidden;background-color:#e0e0e0;border-radius:4px;}
.skeleton::after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.4),transparent);animation:shimmer 4s infinite;}
#iframeOverlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;z-index:1000;background:white;}
#iframeOverlay iframe{width:100%;height:100%;border:none;}
#iframeToggleBtn{position:fixed;bottom:20px;left:20px;width:40px;height:40px;background:#1967d2;color:white;border-radius:9999px;display:flex;align-items:center;justify-content:center;cursor:grab;z-index:1100;font-size:16px;user-select:none;display:none;}
#iframeToggleBtn:active{cursor:grabbing;}
.active-link{background-color:#d2e3fc;color:#1967d2;}
.sidebar-scale{transform:scale(1.05);transform-origin:top left;}
.category-header{font-weight:600;font-size:0.875rem;margin-top:0.5rem;margin-bottom:0.25rem;padding-left:0.75rem;color:#555;cursor:pointer;user-select:none;display:flex;justify-content:space-between;align-items:center;}
.enrolled-item{padding-left:0.5rem;padding-top:0.25rem;padding-bottom:0.25rem;border-radius:4px;display:flex;align-items:center;gap:0.80rem;transition:background 0.15s;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:0.875rem;}
.enrolled-item:hover{background-color:#e3f2fd;}
.favicon-img,.favicon-letter{width:20px;height:20px;flex-shrink:0;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.75rem;font-weight:600;color:#000;background:#cfd8dc;}
/* LOGIN MODAL */
#loginModal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);z-index:2000;align-items:center;justify-content:center;}
#loginModal .modal-content{background:white;padding:1.5rem;border-radius:8px;width:300px;display:flex;flex-direction:column;gap:0.5rem;}
#loginModal input{padding:0.5rem;border:1px solid #ccc;border-radius:4px;}
#loginModal button{padding:0.5rem;border:none;border-radius:4px;background:#1967d2;color:white;cursor:pointer;}
#loginModal button#closeLogin{background:#aaa;}
</style>
</head>
<body class="bg-[#f8fafc] min-h-screen flex">

<!-- Sidebar -->
<aside class="flex flex-col w-64 bg-white border-r border-gray-200 relative z-10 sidebar-scale">
  <header class="flex items-center gap-3 px-5 py-4 border-b border-gray-200">
    <button aria-label="Menu" class="text-gray-700 text-xl"><i class="fas fa-bars"></i></button>
    <img alt="Google Classroom icon" class="w-6 h-6 ml-2" src="https://www.gstatic.com/classroom/ic_product_classroom_144.png">
    <span class="text-gray-800 text-base font-normal select-none ml-2">Classroom</span>
  </header>
  <nav class="flex flex-col mt-4 px-2 space-y-1">
    <a class="flex items-center gap-3 px-3 py-2 rounded-lg bg-[#d2e3fc] text-[#1967d2] text-sm font-medium select-none" href="#"><i class="fas fa-home text-sm"></i> Home</a>
    <a class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-700 text-sm font-normal hover:bg-gray-100 select-none" href="#"><i class="far fa-calendar-alt text-sm"></i> Calendar</a>
    <button id="enrolledBtn" aria-expanded="false" class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-700 text-sm font-normal hover:bg-gray-100 select-none w-full" type="button">
      <i class="fas fa-graduation-cap text-sm"></i> Enrolled
      <i id="enrolledChevron" class="fas fa-chevron-down ml-auto text-xs transition-transform duration-200" style="transform: rotate(-90deg);"></i>
    </button>
    <div id="enrolledList" class="flex flex-col space-y-1 mt-1" style="display:none;">
      <!-- Categories fully restored -->
      <div class="category">
        <div class="category-header">Games <i class="fas fa-chevron-down text-xs" style="transform: rotate(-90deg);"></i></div>
        <div class="category-list">
          <a id="nullLink" data-url="https://nullxiety.com/" class="enrolled-item"></a>
          <a id="totallyLink" data-url="https://weslack.com/" class="enrolled-item"></a>
          <a id="scienceLink" data-url="https://totallyscience.app/" class="enrolled-item"></a>
          <a id="gnLink" data-url="https://gn-math.github.io/" class="enrolled-item"></a>
          <a id="englishLink" data-url="https://www.julios.games/home" class="enrolled-item"></a>
        </div>
      </div>
      <div class="category">
        <div class="category-header">Browser+Games <i class="fas fa-chevron-down text-xs" style="transform: rotate(-90deg);"></i></div>
        <div class="category-list">
          <a id="browserLink" data-url="https://best-force-734.nowgg.me/" class="enrolled-item"></a>
          <a id="spaceLink" data-url="https://erbytes.host2go.net/" class="enrolled-item"></a>
          <a id="randomLink" data-url="https://study.info.north-kazakhstan.su/" class="enrolled-item"></a>
          <a id="utopiLink" data-url="https://meta-games-proxies.crabdance.com/" class="enrolled-item"></a>
          <a id="utopi3Link" data-url="https://bombbombbombiran.ruhezeiter.ch/" class="enrolled-item"></a>
          <a id="utopi5Link" data-url="https://classroom.google.com.my.to/" class="enrolled-item"></a>
          <a id="utopi4Link" data-url="https://apply.freediddy.info/" class="enrolled-item"></a>
        </div>
      </div>
    </div>
    <a class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-700 text-sm font-normal hover:bg-gray-100 select-none" href="#"><i class="far fa-folder text-sm"></i> Archived classes</a>
    <a class="flex items-center gap-3 px-3 py-2 rounded-lg text-gray-700 text-sm font-normal hover:bg-gray-100 select-none" href="#"><i class="fas fa-cog text-sm"></i> Settings<span class="text-xs font-normal ml-auto">›</span></a>
  </nav>
</aside>

<!-- Main -->
<main class="flex-1 p-6 overflow-auto">
  <header class="flex items-center justify-end gap-6 mb-6">
    <button aria-label="Create" class="flex items-center justify-center w-8 h-8 text-gray-700 hover:bg-gray-200 rounded-full transition-colors duration-200">
      <svg aria-hidden="true" class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14" stroke-linecap="round" stroke-linejoin="round"></path></svg>
    </button>
    <button aria-label="Apps" class="text-gray-700 font-light hover:bg-gray-200 rounded-full w-8 h-8 flex items-center justify-center">
      <svg aria-hidden="true" class="w-4 h-4" fill="#5f6368" viewBox="0 0 24 24"><circle cx="4.5" cy="4.5" r="2.5"/><circle cx="12" cy="4.5" r="2.5"/><circle cx="19.5" cy="4.5" r="2.5"/><circle cx="4.5" cy="12" r="2.5"/><circle cx="12" cy="12" r="2.5"/><circle cx="19.5" cy="12" r="2.5"/><circle cx="4.5" cy="19.5" r="2.5"/><circle cx="12" cy="19.5" r="2.5"/><circle cx="19.5" cy="19.5" r="2.5"/></svg>
    </button>
    <button id="profileBtn" aria-label="User profile" class="w-8 h-8 rounded-full flex items-center justify-center text-white font-semibold select-none cursor-pointer" title="Click to change profile color/letter">
      <span id="profileLetter" class="text-sm leading-none"> </span>
    </button>
  </header>

  <section aria-label="Classroom cards" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
    <script>
      for(let i=0;i<5;i++){
        document.write(`<article class="bg-white rounded-lg border border-gray-200 shadow-sm p-4 flex flex-col justify-between min-h-[180px]">
          <div class="flex justify-between items-start mb-4">
            <div class="space-y-2 w-3/4">
              <div class="h-3 skeleton w-2/3"></div>
              <div class="h-3 skeleton w-1/2"></div>
            </div>
            <div class="rounded-full bg-gray-200 w-12 h-12 flex-shrink-0"></div>
          </div>
          <hr class="border-gray-200 mb-3">
        </article>`);
      }
    </script>
  </section>
</main>

<div id="iframeOverlay"><iframe src="" allowfullscreen allow="fullscreen"></iframe></div>
<div id="iframeToggleBtn" title="Show/Hide iframe">⇅</div>

<!-- LOGIN MODAL -->
<div id="loginModal">
  <div class="modal-content">
    <input type="text" id="usernameInput" placeholder="Username">
    <input type="password" id="passwordInput" placeholder="Password">
    <button id="loginBtn">Login</button>
    <button id="closeLogin">Close</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script>
// --- PROFILE & LOGIN ---
const profileBtnEl=document.getElementById('profileBtn');
const profileLetterEl=document.getElementById('profileLetter');
const loginModalEl=document.getElementById('loginModal');
const loginBtnEl=document.getElementById('loginBtn');
const closeLoginEl=document.getElementById('closeLogin');

profileBtnEl.addEventListener('click',()=>{ loginModalEl.style.display='flex'; });
closeLoginEl.addEventListener('click',()=>{ loginModalEl.style.display='none'; });
loginBtnEl.addEventListener('click',()=>{
  const username=document.getElementById('usernameInput').value.trim();
  const password=document.getElementById('passwordInput').value.trim();
  if(!username||!password){alert('Enter username & password'); return;}
  localStorage.setItem('loggedIn','true');
  localStorage.setItem('username',username);
  loginModalEl.style.display='none';
  profileLetterEl.textContent=username.charAt(0).toUpperCase();
  profileBtnEl.style.backgroundColor='#1967d2';
});
if(localStorage.getItem('loggedIn')==='true'){
  const username=localStorage.getItem('username');
  profileLetterEl.textContent=username.charAt(0).toUpperCase();
  profileBtnEl.style.backgroundColor='#1967d2';
}

// --- CATEGORY DROPDOWN ---
document.querySelectorAll('.category-header').forEach(h=>{
  const list=h.nextElementSibling;
  const icon=h.querySelector('i');
  list.classList.remove('open'); icon.style.transform='rotate(-90deg)';
  h.addEventListener('click',()=>{
    const open=list.classList.toggle('open');
    icon.style.transform=open?'rotate(0deg)':'rotate(-90deg)';
  });
});

// --- ENROLLED LINKS ---
document.querySelectorAll('.enrolled-item').forEach(el=>{
  const url=el.dataset.url;
  el.textContent=' ' + new URL(url).hostname.replace(/^www\./,'');
  el.addEventListener('click',()=>{ window.open(url,'_blank'); });
});

// --- ENROLLED TOGGLE ---
const enrolledBtn=document.getElementById('enrolledBtn');
const enrolledList=document.getElementById('enrolledList');
const enrolledChevron=document.getElementById('enrolledChevron');
enrolledBtn.addEventListener('click',()=>{
  const isOpen=enrolledList.style.display==='flex';
  enrolledList.style.display=isOpen?'none':'flex';
  enrolledChevron.style.transform=isOpen?'rotate(-90deg)':'rotate(0deg)';
});

// --- IFRAME & DRAG TOGGLE RESTORED ---
const iframeOverlay=document.getElementById('iframeOverlay');
const iframeEl=iframeOverlay.querySelector('iframe');
const iframeToggleBtn=document.getElementById('iframeToggleBtn');

iframeToggleBtn.addEventListener('click',()=>{ iframeOverlay.style.display=iframeOverlay.style.display==='none'?'block':'none'; });
let isDragging=false,dx=0,dy=0;
iframeToggleBtn.addEventListener('mousedown',e=>{ isDragging=true; dx=e.clientX-iframeToggleBtn.offsetLeft; dy=e.clientY-iframeToggleBtn.offsetTop; iframeToggleBtn.style.cursor='grabbing'; });
document.addEventListener('mousemove',e=>{ if(!isDragging) return; iframeToggleBtn.style.left=`${e.clientX-dx}px`; iframeToggleBtn.style.top=`${e.clientY-dy}px`; });
document.addEventListener('mouseup',()=>{ isDragging=false; iframeToggleBtn.style.cursor='grab'; });
</script>

</body>
</html>
