<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FlareLink Portal</title>
<style>
body {
  margin:0;
  font-family:'Segoe UI',sans-serif;
  background: radial-gradient(circle at bottom,#2a0a4d,#000);
  color:white;
  display:flex;
  flex-direction:column;
  min-height:100vh;
  overflow:hidden;
  position:relative;
}
body::before {
  content:"";
  position:absolute;
  inset:0;
  background:url("https://www.transparenttextures.com/patterns/stardust.png");
  opacity:0.15;
  pointer-events:none;
}

main {
  flex:1;
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap:1.2rem;
  padding:2rem;
  z-index:1;
  position:relative;
}

button.card {
  border:none;
  border-radius:1rem;
  padding:2rem 1rem;
  background: rgba(255,255,255,0.05);
  backdrop-filter: blur(12px);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition: all 0.25s ease;
  color:white;
  font-weight:500;
  font-size:1.2rem;
}

button.card:hover {
  transform: translateY(-4px);
  background: rgba(255,255,255,0.1);
}

.iframe-overlay {
  position:fixed;
  inset:0;
  background: rgba(0,0,0,0.7);
  backdrop-filter: blur(20px);
  display:flex;
  flex-direction:column;
  z-index:1000;
  opacity:0;
  pointer-events:none;
  transition: opacity 0.4s ease;
}

.iframe-overlay.active {
  opacity:1;
  pointer-events:all;
}

.iframe-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:0.6rem 1rem;
  background: rgba(20,20,20,0.7);
  border-bottom:1px solid rgba(255,255,255,0.1);
}

.iframe-header span {
  flex:1;
  margin-left:0.5rem;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.iframe-header button {
  background:none;
  border:none;
  color:white;
  font-size:1.1rem;
  cursor:pointer;
}

.iframe-overlay iframe {
  flex:1;
  border:none;
  width:100%;
  opacity:0;
  transition: opacity 0.5s ease;
}

.iframe-overlay iframe.loaded {
  opacity:1;
}

.controls {
  margin-top:0.5rem;
  display:flex;
  gap:10px;
  justify-content:flex-end;
  padding:0.5rem 1rem;
}

.controls button {
  background: rgba(255,255,255,0.1);
  border:none;
  color:white;
  padding:5px 10px;
  border-radius:6px;
  cursor:pointer;
  transition:0.2s;
}

.controls button:hover {
  background: rgba(255,255,255,0.2);
}
</style>
</head>
<body>

<main id="cardGrid"></main>

<div id="iframeOverlay" class="iframe-overlay">
  <div class="iframe-header">
    <span id="iframeTitle"></span>
    <button id="closeBtn">âœ•</button>
  </div>
  <iframe id="iframeViewer" src=""></iframe>
  <div class="controls">
    <button id="shuffleBtn">ðŸ”€ Shuffle</button>
  </div>
</div>

<script>
// FlareLink services configuration
const services = {
  Xen: { wildcard:"xen", domains:["deltamath.icu"] },
  Nebula: { wildcard:"nb", domains:["goguardian.pro"] },
  Terbium: { wildcard:"tb", domains:["terbium.site","nearpod.lol"] },
  DaydreamX: { wildcard:"ddx", domains:["blocksi.lol","daydreamx.net"] },
  Lunar: { wildcard:"lunar", domains:["lunar.gg","studentvue.my"] },
  Space: { wildcard:"space", domains:["desmos.lol","desmosgraphing.xyz"] }
};

// DOM elements
const cardGrid = document.getElementById("cardGrid");
const iframeOverlay = document.getElementById("iframeOverlay");
const iframeViewer = document.getElementById("iframeViewer");
const iframeTitle = document.getElementById("iframeTitle");
const closeBtn = document.getElementById("closeBtn");
const shuffleBtn = document.getElementById("shuffleBtn");

let currentService = null;
let lastIndex = -1;

// Random subdomain generator
function randomSubdomain(len=4) {
  const chars = "abcdefghijklmnopqrstuvwxyz0123456789";
  let str;
  do {
    str = Array.from({length: len}, () => chars[Math.floor(Math.random()*chars.length)]).join("");
  } while(str === lastIndex);
  lastIndex = str;
  return str;
}

// Build wildcard CDN URL
function buildFlareLink(serviceName) {
  const service = services[serviceName];
  const domain = service.domains[Math.floor(Math.random()*service.domains.length)];
  const sub = randomSubdomain();
  return `${sub}.${service.wildcard}.${domain}.cdn.cloudflare.net`;
}

// Create cards
Object.keys(services).forEach(name => {
  const btn = document.createElement("button");
  btn.className = "card";
  btn.textContent = name;
  btn.onclick = () => openService(name);
  cardGrid.appendChild(btn);
});

// Open a service in the iframe
function openService(name) {
  currentService = name;
  showRandomLink();
  iframeOverlay.classList.add("active");
}

function showRandomLink() {
  if (!currentService) return;
  iframeViewer.classList.remove("loaded");
  iframeViewer.src = buildFlareLink(currentService);
  iframeTitle.textContent = currentService;
}

// Shuffle button
shuffleBtn.onclick = showRandomLink;

// Close iframe
closeBtn.onclick = () => {
  iframeOverlay.classList.remove("active");
  iframeViewer.src = "";
};

iframeViewer.onload = () => iframeViewer.classList.add("loaded");
</script>

</body>
</html>
